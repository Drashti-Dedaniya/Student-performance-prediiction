<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Profile</title>

<style>
body{
  font-family:Segoe UI;
  background:#a6a6da;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

.card{
  background:#e3ddff;
  padding:30px;
  border-radius:22px;
  width:380px;
  box-shadow:0 15px 30px rgba(0,0,0,0.2);
}

h2{
  text-align:center;
  margin-bottom:20px;
}

label{
  font-weight:600;
  margin-top:12px;
  display:block;
}

input,button{
  width:100%;
  padding:10px;
  margin-top:6px;
  border-radius:10px;
  border:none;
  font-size:14px;
}

input{
  background:#fff;
}

button{
  background:#4a4a86;
  color:white;
  margin-top:20px;
  cursor:pointer;
}

button:hover{
  opacity:0.9;
}

/* PROFILE PHOTO */
.photo-wrapper{
  position:relative;
  width:120px;
  height:120px;
  margin:0 auto 20px;
  cursor:pointer;
}

.profile-pic{
  width:120px;
  height:120px;
  border-radius:50%;
  object-fit:cover;
  border:4px solid #4a4a86;
}

.camera-icon{
  position:absolute;
  bottom:6px;
  right:6px;
  background:#4a4a86;
  color:white;
  width:34px;
  height:34px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:16px;
  box-shadow:0 4px 8px rgba(0,0,0,0.3);
}

/* Parent section */
#parentSection{
  margin-top:20px;
  padding-top:15px;
  border-top:2px dashed #b2a7ff;
}

.msg{
  margin-top:8px;
  color:green;
  font-size:14px;
}
</style>
</head>

<body>

<div class="card">

  <h2>ðŸ‘¤ Profile</h2>

  <!-- Profile Photo -->
  <div class="photo-wrapper" onclick="openFile()">
    <img id="photo" class="profile-pic">
    <div class="camera-icon">ðŸ“·</div>
  </div>

  <input type="file" id="fileInput" accept="image/*" hidden onchange="uploadPhoto(event)">

  <!-- Editable Info -->
  <label>Name</label>
  <input id="name">

  <label>Email</label>
  <input id="email">

  <label>Role</label>
  <input id="role" disabled>

  <!-- Parent Only -->
  <div id="parentSection" style="display:none;">
    <h3>ðŸ‘¶ Child Information</h3>
    <input id="childName" placeholder="Enter Child Name">
    <button onclick="saveChild()">Save Child Name</button>
    <p class="msg" id="msg"></p>
  </div>

  <button onclick="saveProfile()">ðŸ’¾ Save Profile</button>

</div>

<script>
function openFile(){
  document.getElementById("fileInput").click();
}

function uploadPhoto(event){
  let reader = new FileReader();
  reader.onload = function(){
    document.getElementById("photo").src = reader.result;
    localStorage.setItem("profilePhoto", reader.result);
  };
  reader.readAsDataURL(event.target.files[0]);
}

window.onload = function(){
  let user = JSON.parse(localStorage.getItem("loggedUser"));
  if(!user){
    window.location.href="login.html";
    return;
  }

  document.getElementById("name").value = user.name;
  document.getElementById("email").value = user.email;
  document.getElementById("role").value = user.role;

  let savedPhoto = localStorage.getItem("profilePhoto");
  document.getElementById("photo").src =
    savedPhoto || "https://via.placeholder.com/120";

  if(user.role === "Parent"){
    document.getElementById("parentSection").style.display = "block";
    document.getElementById("childName").value =
      localStorage.getItem("childName") || "";
  }
};

function saveProfile(){
  let user = JSON.parse(localStorage.getItem("loggedUser"));

  user.name = document.getElementById("name").value;
  user.email = document.getElementById("email").value;

  localStorage.setItem("loggedUser", JSON.stringify(user));
  alert("âœ… Profile updated successfully");
}

function saveChild(){
  let name = document.getElementById("childName").value;
  if(!name){
    alert("Please enter child name");
    return;
  }
  localStorage.setItem("childName", name);
  document.getElementById("msg").innerText = "Child name saved successfully";
}
</script>

</body>
</html>
