<!DOCTYPE html>
<html>
<head>
<title>Profile</title>
<style>
body{
  font-family: Segoe UI;
  background:#a6a6da;
  padding:30px;
}

.card{
  background:#dcd3ff;
  padding:25px;
  border-radius:20px;
  max-width:420px;
  margin:auto;
  box-shadow:0 10px 20px rgba(0,0,0,0.15);
  text-align:center;
}

.profile-pic{
  width:120px;
  height:120px;
  border-radius:50%;
  object-fit:cover;
  border:4px solid #4a4a86;
  margin-bottom:10px;
}

input,button{
  width:100%;
  padding:10px;
  margin-top:10px;
  border-radius:10px;
  border:none;
}

button{
  background:#4a4a86;
  color:white;
  cursor:pointer;
}

label{
  float:left;
  margin-top:10px;
  font-weight:600;
}

hr{
  margin:20px 0;
}
</style>
</head>

<body>

<div class="card">
  <h2>ðŸ‘¤ Profile</h2>

  <!-- PROFILE PHOTO -->
  <img id="photo" class="profile-pic" src="" alt="Profile Photo">
  <input type="file" accept="image/*" onchange="uploadPhoto(event)">

  <!-- EDITABLE INFO -->
  <label>Name</label>
  <input id="name">

  <label>Email</label>
  <input id="email">

  <label>Role</label>
  <input id="role" disabled>

  <button onclick="saveProfile()">ðŸ’¾ Save Profile</button>

  <!-- âœ… PARENT ONLY -->
  <div id="parentSection" style="display:none;">
    <hr>
    <h3>ðŸ‘¶ Child Information</h3>
    <input id="childName" placeholder="Enter Child Name">
    <button onclick="saveChild()">Save Child Name</button>
    <p id="msg"></p>
  </div>
</div>

<script>
window.onload = function(){
  let user = JSON.parse(localStorage.getItem("loggedUser"));
  if(!user){
    window.location.href="login.html";
    return;
  }

  document.getElementById("name").value = user.name;
  document.getElementById("email").value = user.email;
  document.getElementById("role").value = user.role;

  // load photo
  let photo = localStorage.getItem("profilePhoto");
  document.getElementById("photo").src =
    photo || "https://via.placeholder.com/120";

  // parent section
  if(user.role === "Parent"){
    document.getElementById("parentSection").style.display = "block";
    document.getElementById("childName").value =
      localStorage.getItem("childName") || "";
  }
};

// SAVE PROFILE
function saveProfile(){
  let user = JSON.parse(localStorage.getItem("loggedUser"));

  user.name = document.getElementById("name").value;
  user.email = document.getElementById("email").value;

  localStorage.setItem("loggedUser", JSON.stringify(user));
  alert("âœ… Profile updated successfully");
}

// PHOTO UPLOAD
function uploadPhoto(event){
  let reader = new FileReader();
  reader.onload = function(){
    document.getElementById("photo").src = reader.result;
    localStorage.setItem("profilePhoto", reader.result);
  };
  reader.readAsDataURL(event.target.files[0]);
}

// SAVE CHILD
function saveChild(){
  let name = document.getElementById("childName").value;
  if(!name){
    alert("Please enter child name");
    return;
  }
  localStorage.setItem("childName", name);
  document.getElementById("msg").innerText =
    "âœ… Child name saved successfully";
}
</script>

</body>
</html>
